Добавить валидацию везде.

Продолжить рефакторинг если понадобится.